<!DOCTIPE html>
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<head>
	  <title>
	    PPV - EJNS
	  </title>
	  <script src="js/sessionCookie.js" type="text/javascript"></script>
	</head>
	<!--<link rel="stylesheet" type="text/css" href="css/index.css" />-->
	<link rel="stylesheet" type="text/css" href="css/style.css" />
	<body>
	  <h1 class="titulo"> PPV - Plano Pessoal de Vida </h1>
	  <form id="login" onsubmit="return false;">
	    <label class="login-label" for="usuario">Usuário:</label><br>
	    <input id="usuario" type="text" /><br><br>	
	    <label class="login-label" for="senha">Senha:</label><br>
	    <input id="senha" type="password" /><br><br>
	    <input type="button" value="Entrar" onclick="autenticar();" />
	  </form>
	</body>
</html>
<script language="JavaScript">
  /*function autenticar() {
  	window.location.href = "seleciona_tela.html";
  }*/

  function autenticar(){

  	var Ajax = new XMLHttpRequest();

    var oParams = new Object();
  	oParams.method = 'autenticar';
  	oParams.login  = document.getElementById('usuario').value;
  	oParams.senha  = document.getElementById('senha').value;

    Ajax.open("POST", "http://localhost:4343/EJNS/index.php?oParams="+JSON.stringify(oParams), true);
    Ajax.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

    Ajax.onreadystatechange = function () {
        console.log(response);
        var response = "";

        if (Ajax.readyState == 1) {
            response += "Status 1: Server connection established!";
        } else if (Ajax.readyState == 2) {
            response += "Status 2: Request recieved!";
        } else if (Ajax.readyState == 3) {
            response += "Status 3: Processing Request!";

        } else if (Ajax.readyState == 4) {
            if (Ajax.status == 200) {
                var response = Ajax.responseText;
                alert(response);
                writeCookie('tipo_usuario', 1, 3);
                window.location.href = "seleciona_tela.html";
            } else {
                alert("Ocorreu algum erro. Contate o administrador!");
            }
        }
    }
    //If an error occur during the Ajax call.
    if (Ajax.readyState == 4 && Ajax.status == 404) {
        alert("Erro na requisição ao servidor.");
    }

    Ajax.send(JSON.stringify(oParams));
  }
</script>